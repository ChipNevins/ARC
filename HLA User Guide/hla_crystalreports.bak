<HTML>
<HEAD>
<H1>Crystal Reports in HLA System</H1>
</HEAD>

<BODY>
<Font Face="Tahoma" size=3>
Last revision: March 26, 2004
&nbsp;&nbsp;
<A HREF=#top>To print this page, Click here first</A>

<HR ALIGN="left">

<h3>General information</h3>
<ul>
<li>We have one standalone copy of Crystal Reports, installed on Chip's PC in the server area. This product is a reporting tool, which you can use to create reports from the data in Oracle.
<li>You can create a new report, or you can run a report which is already created. You must have an Oracle login account to use Crystal reports.
<li>The folder R:/hla/reports contains the reports already created
<li>This tool does retrieval only - there is no way you can <b>alter</b> any data in Oracle by using Crystal Reports!
</ul>

<h3>Starting and using Crystal reports</h3>
<ol>
<li>Double-click the desktop icon to start the application.
<li>To run a report, select File|Open, browse to r:/hla/reports/, and select the report you wish to run. The computer oens the report in design mode.
<li>Press the 'F5' key to run the report, or click the lightening bolt icon
<li>If the report has run-time parameters, e.g. from date and through date, the program will prompt for these values.
<li>You will be prompted for your Oracle username and password.
<li>The report runs and is displayed on your screen, with a page count.  You can browse through the report on your screen, and you can print the report.
<li>When you open a report, you have access to both the report data and the report definition, so you can alter the report. You can change the sort order, print fields, formatting, selection criteria, and lots of other things. To do this, however, you will need training. The user manual is in the file cabinet in the server cubicle, and you can ask Chip for help.
<li>When you alter print fields or selection criteria, press F5 to refresh the report. If you are only repositioning fields or changing the sort order, you do not need to refresh the data.
<li>When you <b>save changes</b>, you are saving only the changes in the report definition. No data changes are being saved to Oracle.
</ol>

<h3>Basics of Creating a New Report</h3>
Note: The Crystal Reports manual has both a fast-track tutorial and detailed explanations of how to create reports. The brief descriptions below are not meant to be a replacement for this manual.
<ol>
<li>With the Crystal Reports application started, select File|New
<li>The Report Gallery window opens. Select the option 'As a Blank Report', then click OK
<li>The Data Explorer window opens. (Note that you can also open this window by selecting Database|Add Database to Report.) Expand the folder named 'More Data Sources', then expand the folder 'Oracle Server'. As soon as you expand Oracle Server, the system presents a login window - enter these values:
  <ul>
  <li>Username:  &ltyour username&gt
  <li>Password:  &ltyour password&gt
  <li>Server:    hlaprod
  </ul>
<li>After you log in, the Data Explorer window displays the list of tables. Select the table or tables which contain the data items you want, then click ADD, then CLOSE. (Select multiple tables by holding down the CTRL key).
<li>The Visual Link Expert window opens.  The links you need should already be set, so you can just click OK to close this window.
<li>The Field Explorer window opens. (Note that you can also open this window by selecting Insert|Database Field). Expand the tablenames to show all of the fields, then drag the fieldnames into the Data sectin of the report panel.
<li>To define the retrieval criteria for the report:
  <ul>
  <li>Select Report|Select Expert. The Choose a Field window opens. Select the field that you want to use for your selection criteria. E.g. to select tests ordered in Dec 2003, select the field ORDERDATE in table v_HLA_TEST.
  <li>The Select Expert window opens, with the field you just selected listed. Choose a n operator from the drop-down list, such as 'Is equal to' or 'is between', then follow the prompts.
  </ul>
<li>To define the sort values, select Report|Sort Records.
<li>Running a report: Press the F5 key. If the report will include more than 500 rows, the system will present a window asking if you want to proceed.  E.g., 'This report will return 331,622 records - do you want to proceed?' This gives you a chance to prevent most runaway queries.
<li>Saving your report: Select File|Save, and select the r:\hla\reports\ folder as the destination folder for the report.
<li>Hiding/Displaying the report detail. Select menu item Format|Section, the computer opens the Section Expert window. In the list of sections, click 'Details', then check the box named 'Hide (Drill-down OK)'. Click OK to dismiss the window.  The report will now show only the summaries. To display detail, un-check this box.
</ol>


<h3>Technical Information</h3>
<ul>
<li>Chip created Oracle VIEWS to be use with Crystal reports, e.g. V_HLA_PERSON. These views join data in the underlying tables so that report users do not need to know all of the details.
<li>In V_HLA_PERSON, there are two Donor Location fields defined: (1)DonorLocation, a text value you can report; (2) DonorLocation link, a link to the code table so you can report the short name of the donor location if you want to.
</ul>
</BODY>
</HTML>
